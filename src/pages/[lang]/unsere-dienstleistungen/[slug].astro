---
import { getCollection } from 'astro:content';
import MainLayout from '../../../layouts/MainLayout.astro';

export async function getStaticPaths() {
  const allSunduklarimiz = await getCollection('unsere-dienstleistungen');
  
  const paths = [];
  
  for (const hizmet of allSunduklarimiz) {
    // Astro removes dots from slugs, so "universite-yerlestirme.tr.md" becomes "universite-yerlestirmetr"
    // We need to check if slug ends with language code (tr, de, en)
    const slug = hizmet.slug;
    const langCode = hizmet.data.lang;
    
    // Check if slug ends with the language code
    // e.g., "universite-yerlestirmetr" ends with "tr"
    if (!slug.endsWith(langCode)) {
      continue;
    }
    
    // Remove language code from end of slug
    // "universite-yerlestirmetr" -> "universite-yerlestirme"
    const cleanSlug = slug.slice(0, -langCode.length);
    
    paths.push({
      params: { 
        lang: langCode,
        slug: cleanSlug
      },
      props: { hizmet },
    });
  }
  
  return paths;
}

const { hizmet } = Astro.props;
const { Content } = await hizmet.render();
const { lang } = Astro.params;
---

<MainLayout title={`${hizmet.data.title} - CampusGerman`} lang={lang} includeHizmetCSS={true}>
    <!-- Main Content -->
    <main>
        <!-- Article Section -->
        <section class="article-section">
            <div class="container">
                <div class="article-layout">
                    <!-- Article Content -->
                    <article class="article-content">
                        <div class="article-header">
                            <h1 class="article-title">{hizmet.data.title}</h1>
                            <div class="article-meta">
                                <span class="article-date">
                                    <i class="fas fa-calendar"></i>
                                    {hizmet.data.date}
                                </span>
                                <span class="article-author">
                                    <i class="fas fa-user"></i>
                                    {hizmet.data.author}
                                </span>
                                <span class="article-category">
                                    <i class="fas fa-tag"></i>
                                    {hizmet.data.category}
                                </span>
                            </div>
                        </div>

                        <div class="article-image">
                            <img src={hizmet.data.image} alt={hizmet.data.title}>
                        </div>

                        <div class="article-body">
                            <Content />
                        </div>

                        <div class="article-footer">
                            <div class="article-tags">
                                <span class="tag-label">{lang === 'tr' ? 'Etiketler:' : 'Tags:'}</span>
                                <a href="#" class="tag">{lang === 'tr' ? 'Almanca' : 'Deutsch'}</a>
                                <a href="#" class="tag">{lang === 'tr' ? 'Hizmetler' : 'Dienstleistungen'}</a>
                                <a href="#" class="tag">{lang === 'tr' ? 'CampusGerman' : 'CampusGerman'}</a>
                            </div>
                            <div class="article-share">
                                <span class="share-label">{lang === 'tr' ? 'Paylaş:' : 'Teilen:'}</span>
                                <a href="#" class="share-link" aria-label="Facebook">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="#" class="share-link" aria-label="Twitter">
                                    <i class="fab fa-twitter"></i>
                                </a>
                                <a href="#" class="share-link" aria-label="LinkedIn">
                                    <i class="fab fa-linkedin-in"></i>
                                </a>
                                <a href="#" class="share-link" aria-label="WhatsApp">
                                    <i class="fab fa-whatsapp"></i>
                                </a>
                            </div>
                        </div>
                    </article>

                    <!-- Sidebar -->
                    <aside class="article-sidebar">
                        <!-- Quick Contact Widget -->
                        <div class="sidebar-widget">
                            <h3 class="widget-title">
                                <i class="fas fa-phone-alt"></i>
                                {lang === 'tr' ? 'Hızlı İletişim' : 'Schneller Kontakt'}
                            </h3>
                            <div class="widget-content">
                                <p>{lang === 'tr' ? 'Hizmetlerimiz hakkında daha fazla bilgi almak için bizimle iletişime geçin.' : 'Kontaktieren Sie uns für weitere Informationen zu unseren Dienstleistungen.'}</p>
                                <a href={`/${lang}/kontakt`} class="widget-button">
                                    <i class="fas fa-envelope"></i>
                                    {lang === 'tr' ? 'İletişime Geç' : 'Kontakt aufnehmen'}
                                </a>
                            </div>
                        </div>

                        <!-- Related Services Widget -->
                        <div class="sidebar-widget">
                            <h3 class="widget-title">
                                <i class="fas fa-list"></i>
                                {lang === 'tr' ? 'Diğer Hizmetlerimiz' : 'Weitere Dienstleistungen'}
                            </h3>
                            <div class="widget-content">
                                <ul class="related-list">
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/universite-yerlestirme`}>
                                            <i class="fas fa-university"></i>
                                            {lang === 'tr' ? 'Üniversite Yerleştirme' : 'Universitätsvermittlung'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/vize-rehberligi`}>
                                            <i class="fas fa-passport"></i>
                                            {lang === 'tr' ? 'Vize Rehberliği' : 'Visumsberatung'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/konaklama`}>
                                            <i class="fas fa-home"></i>
                                            {lang === 'tr' ? 'Konaklama' : 'Unterkunft'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/havalimani-karsilama`}>
                                            <i class="fas fa-plane-arrival"></i>
                                            {lang === 'tr' ? 'Havaalanı Karşılama' : 'Flughafenabholung'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/saglik-sigorta-banka`}>
                                            <i class="fas fa-credit-card"></i>
                                            {lang === 'tr' ? 'Sağlık Sigortası/Banka' : 'Krankenversicherung/Bank'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/burokrasi-destek`}>
                                            <i class="fas fa-file-alt"></i>
                                            {lang === 'tr' ? 'Bürokrasi Desteği' : 'Bürokratische Unterstützung'}
                                        </a>
                                    </li>
                                    <li>
                                        <a href={`/${lang}/unsere-dienstleistungen/ucretsiz-kaynaklar`}>
                                            <i class="fas fa-book-open"></i>
                                            {lang === 'tr' ? 'Ücretsiz Kaynaklar' : 'Kostenlose Ressourcen'}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- CTA Widget -->
                        <div class="sidebar-widget cta-widget">
                            <h3 class="widget-title">
                                <i class="fas fa-rocket"></i>
                                {lang === 'tr' ? 'Hemen Başla' : 'Jetzt starten'}
                            </h3>
                            <div class="widget-content">
                                <p>{lang === 'tr' ? 'Almanca öğrenme yolculuğunuza bugün başlayın!' : 'Starten Sie heute Ihre Deutschlernreise!'}</p>
                                <a href={`/${lang}/buchung`} class="widget-cta-button">
                                    <i class="fas fa-arrow-right"></i>
                                    {lang === 'tr' ? 'Hemen Başvur Yap' : 'Jetzt bewerben'}
                                </a>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="container">
                <div class="cta-content">
                    <div class="cta-text">
                        <h2 class="cta-title">{lang === 'tr' ? 'Hizmetlerimizden Yararlanmaya Hazır mısınız?' : 'Bereit, unsere Dienstleistungen zu nutzen?'}</h2>
                        <p class="cta-description">
                            {lang === 'tr' 
                                ? 'CampusGerman ile Almanca öğrenme yolculuğunuza başlayın. Uzman eğitmenlerimiz ve modern eğitim metodlarımızla hedeflerinize ulaşın.'
                                : 'Starten Sie Ihre Deutschlernreise mit CampusGerman. Erreichen Sie Ihre Ziele mit unseren Expertenlehrern und modernen Unterrichtsmethoden.'}
                        </p>
                        <div class="cta-buttons">
                            <a href={`/${lang}/buchung`} class="cta-primary">
                                <i class="fas fa-arrow-right"></i>
                                {lang === 'tr' ? 'Hemen Başvur Yap' : 'Jetzt bewerben'}
                            </a>
                            <a href={`/${lang}/kontakt`} class="cta-secondary">
                                <i class="fas fa-envelope"></i>
                                {lang === 'tr' ? 'İletişime Geç' : 'Kontakt aufnehmen'}
                            </a>
                        </div>
                    </div>
                    <div class="cta-form">
                        <div class="form-header">
                            <h3>{lang === 'tr' ? 'Ücretsiz Bilgi Alın' : 'Kostenlose Informationen'}</h3>
                            <p>{lang === 'tr' ? 'Size en uygun programı bulalım' : 'Lassen Sie uns das richtige Programm für Sie finden'}</p>
                        </div>
                        <form class="contact-form">
                            <div class="form-group">
                                <input type="text" id="name" name="name" placeholder={lang === 'tr' ? 'Adınız Soyadınız' : 'Ihr Name'} required>
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="form-group">
                                <input type="email" id="email" name="email" placeholder={lang === 'tr' ? 'E-posta Adresiniz' : 'Ihre E-Mail'} required>
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="form-group">
                                <input type="tel" id="phone" name="phone" placeholder={lang === 'tr' ? 'Telefon Numaranız' : 'Ihre Telefonnummer'} required>
                                <i class="fas fa-phone"></i>
                            </div>
                            <button type="submit" class="submit-btn">
                                <i class="fas fa-paper-plane"></i>
                                <span>{lang === 'tr' ? 'Ücretsiz Bilgi Al' : 'Kostenlose Informationen anfordern'}</span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>
</MainLayout>

